generator client {
  provider = "prisma-client-js"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model brand {
  id        String    @id
  name      String
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now())
  createdBy String?
  updatedAt DateTime?
  updatedBy String?
  product   product[]
}

model category {
  id        String    @id
  name      String
  createdAt DateTime  @default(now())
  createdBy String?
  updatedAt DateTime?
  updatedBy String?
  isActive  Boolean   @default(true)
  product   product[]
}

model product {
  id                String            @id
  code              String            @unique(map: "Product_code_key")
  name              String
  price             Float             @default(0)
  stock             Int               @default(0)
  unit              String
  isActive          Boolean           @default(true)
  storageLocationId String
  supplierId        String?
  productCategoryId String
  condition         product_condition @default(New)
  restockDate       DateTime          @default(now())
  imageUrl          String?
  barcode           String?
  createdAt         DateTime          @default(now())
  createdBy         String?
  updatedAt         DateTime?
  updatedBy         String?
  brandId           String?
  brand             brand?            @relation(fields: [brandId], references: [id], map: "Product_brandId_fkey")
  category          category          @relation(fields: [productCategoryId], references: [id], map: "Product_productCategoryId_fkey")
  storagelocation   storagelocation   @relation(fields: [storageLocationId], references: [id], map: "Product_storageLocationId_fkey")
  supplier          supplier?         @relation(fields: [supplierId], references: [id], map: "Product_supplierId_fkey")
  stockadjustment   stockadjustment[]

  @@index([brandId], map: "Product_brandId_fkey")
  @@index([productCategoryId], map: "Product_productCategoryId_fkey")
  @@index([storageLocationId], map: "Product_storageLocationId_fkey")
  @@index([supplierId], map: "Product_supplierId_fkey")
}

model stockadjustment {
  id         String   @id
  productId  String
  oldQty     Int
  newQty     Int
  type       String
  difference Int
  reason     String
  note       String   @db.VarChar(255)
  createdBy  String
  createdAt  DateTime @default(now())
  product    product  @relation(fields: [productId], references: [id], onDelete: Cascade, map: "StockAdjustment_productId_fkey")

  @@index([productId], map: "StockAdjustment_productId_fkey")
}

model storagelocation {
  id              String                @id
  code            String                @unique(map: "StorageLocation_code_key")
  name            String
  description     String?
  type            storagelocation_type?
  zone            String?
  maxCapacity     Int?
  currentCapacity Int?
  capacityUnit    String?
  isActive        Boolean               @default(true)
  createdAt       DateTime              @default(now())
  createdBy       String?
  updatedAt       DateTime?
  updatedBy       String?
  product         product[]
}

model supplier {
  id        String    @id
  name      String
  isActive  Boolean   @default(true)
  createdAt DateTime  @default(now())
  createdBy String?
  updatedAt DateTime?
  updatedBy String?
  product   product[]
}

model user {
  id        String    @id
  email     String    @unique(map: "User_email_key")
  username  String
  password  String
  createdAt DateTime  @default(now())
  createdBy String?
  updatedAt DateTime?
  updatedBy String?
}

enum storagelocation_type {
  rack
  shelf
  drawer
  box
  cabinet
  bin
}

enum product_condition {
  New
  Used
  Refurbished
}
  